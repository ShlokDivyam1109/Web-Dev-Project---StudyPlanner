{% extends "base.html" %}

{% block title %}Edit Plan - Study Planner{% endblock %}

{% block extra_styles %}
  <style>
    .editor-container { max-width: 1000px; }
    .plan-header { display:flex; align-items:center; justify-content:space-between; gap:20px; margin-bottom:20px; }
    .plan-info { background:white; padding:16px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
    .schedule-list { display:grid; gap:12px; }
    .entry { background:white; padding:12px; border-radius:8px; display:flex; gap:12px; align-items:center; box-shadow:0 2px 6px rgba(0,0,0,0.04); }
    .entry input[type="date"]{ padding:8px; border-radius:6px; border:1px solid #ddd; }
    .entry .meta { flex:1; }
    .entry .actions { display:flex; gap:8px; }
    .btn { padding:8px 12px; border-radius:6px; border:none; cursor:pointer; font-weight:600; }
    .btn.save { background:#28a745; color:white; }
    .btn.small { padding:6px 10px; font-size:13px; }
    .btn.secondary { background:#6c757d; color:white; }
  </style>
{% endblock %}

{% block content %}
  <div class="page-header">
    <h1>Edit Plan: {{ plan.name }}</h1>
    <p>Edit schedule entries and adjust dates as needed.</p>
  </div>

  <div class="editor-container">
    <div class="plan-header">
      <div class="plan-info">
        <div><strong>Start Date:</strong> &nbsp;&nbsp;&nbsp;&nbsp; {{ plan.start_date }}</div>
        <div><strong>End Date:</strong> &nbsp;&nbsp;&nbsp;&nbsp; {{ plan.end_date }}</div>
        <div><strong>Preferred Days:</strong> &nbsp;&nbsp;&nbsp;&nbsp; {{ plan.preferred_days }}</div>
      </div>
      <div>
        <a href="/plans" style="text-decoration:none;"><button class="btn secondary small">Back to Plans</button></a>
      </div>
    </div>

    <form method="POST">
      <div class="schedule-list">
        {% for entry in schedule %}
        <div class="entry">
          <div class="meta">
            <div style="font-weight:700;">{{ entry.subject }} â€” {{ entry.topic }}</div>
            <div style="font-size:13px; color:#666; margin-top:6px;">Weightage: {{ entry.weightage }}%</div>
          </div>
          <div>
            <label>From</label>
            <input type="date" name="from_{{ entry.id }}" value="{{ entry.from_date }}">
          </div>
          <div>
            <label>To</label>
            <input type="date" name="to_{{ entry.id }}" value="{{ entry.to_date }}">
          </div>
          <div class="actions">
            <button type="submit" name="save_single" value="{{ entry.id }}" class="btn save small">Save</button>
          </div>
        </div>
        {% endfor %}
      </div>

      <div style="margin-top:16px; text-align:right;">
        <button type="submit" class="btn save">Save All Changes</button>
      </div>
    </form>
  </div>
{% endblock %}
